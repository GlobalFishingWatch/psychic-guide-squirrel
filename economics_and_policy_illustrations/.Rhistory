sum_effort   <- effort_january %>% group_by(week,cell) %>% summarise(effort=sum(fishing_hours))
grid <- dgcellstogrid(dggs,sum_effort$cell,frame=TRUE,wrapcells=TRUE)
grid <- merge(grid,sum_effort,by.x="Name",by.y="cell")
grid$effort    <- log(grid$effort)
p <- ggmap::ggmap(ggmap::get_map(location = c(-89,2,-84,2), zoom = 6,  maptype = c("satellite"), source = 'google'))+
geom_polygon(data=grid, aes(x=long, y=lat, group=group, fill=effort, frame = week), alpha=0.6)    +
geom_path   (data=grid,      aes(x=long, y=lat, group=group), alpha=0.4, color="white") +
scale_fill_gradient(low="yellow", high="red")+
theme_minimal()
View(effort_january)
View(grid)
effort_january$fishing_hours[effort_january$fishing_hours == 0] <- NA
View(effort_january)
dggs <- dgconstruct(spacing=25, metric=FALSE, resround='nearest')
effort_january$cell <- dgtransform(dggs,effort_january$lat,effort_january$lon)
effort_january$cell <- dgtransform(dggs,effort_january$lat,effort_january$lon)
sum_effort   <- effort_january %>% group_by(week,cell) %>% summarise(effort=sum(fishing_hours))
grid <- dgcellstogrid(dggs,sum_effort$cell,frame=TRUE,wrapcells=TRUE)
grid <- merge(grid,sum_effort,by.x="Name",by.y="cell")
grid$effort    <- log(grid$effort)
p <- ggmap::ggmap(ggmap::get_map(location = c(-89,2,-84,2), zoom = 6,  maptype = c("satellite"), source = 'google'))+
geom_polygon(data=grid, aes(x=long, y=lat, group=group, fill=effort, frame = week), alpha=0.6)    +
geom_path   (data=grid,      aes(x=long, y=lat, group=group), alpha=0.4, color="white") +
scale_fill_gradient(low="yellow", high="red")+
theme_minimal()
gganimate::gg_animate(p, interval = .5)
library(tidyverse)
library(bigrquery)
library(DBI)
library(lubridate)
library(dygraphs)
library(dggridR)
library(ggmap)
library(tidyverse)
library(bigrquery)
library(DBI)
library(lubridate)
library(dygraphs)
library(dggridR)
library(ggmap)
BQ_connection <-  dbConnect(dbi_driver(), dataset = "", project = "ucsb-gfw")
effort_january <- effort_january %>%
mutate(week = week(date))
effort_january$fishing_hours[effort_january$fishing_hours == 0] <- NA
dggs <- dgconstruct(spacing=25, metric=FALSE, resround='nearest')
effort_january$cell <- dgtransform(dggs,effort_january$lat,effort_january$lon)
sum_effort   <- effort_january %>% group_by(week,cell) %>% summarise(effort=sum(fishing_hours, na.rm = TRUE))
grid <- dgcellstogrid(dggs,sum_effort$cell,frame=TRUE,wrapcells=TRUE)
grid <- merge(grid,sum_effort,by.x="Name",by.y="cell")
grid$effort    <- log(grid$effort)
p <- ggmap::ggmap(ggmap::get_map(location = c(-89,2,-84,2), zoom = 6,  maptype = c("satellite"), source = 'google'))+
geom_polygon(data=grid, aes(x=long, y=lat, group=group, fill=effort, frame = week), alpha=0.6)    +
geom_path   (data=grid,      aes(x=long, y=lat, group=group), alpha=0.4, color="white") +
scale_fill_gradient(low="yellow", high="red")+
theme_minimal()
gganimate::gg_animate(p, interval = .5)
gganimate::gg_animate(p, interval = .2)
gganimate::gg_animate(p, "ETP.mp4",interval = .3)
BQ_connection <-  dbConnect(dbi_driver(),dataset = "", project = "high-seas")
dggs <- dgconstruct(spacing=25, metric=FALSE, resround='nearest')
removed_vessels_effort_2015$cell <- dgtransform(dggs,removed_vessels_effort_2015$lat,removed_vessels_effort_2015$lon)
removed_vessels_effort_2015 <- removed_vessels_effort_2015 %>%
mutate(dh = round_date(timestamp, unit = "hours")) %>%
arrange(dh)
point_counts   <- removed_vessels_effort_2015 %>%
mutate(dh = round_date(timestamp, unit = "hours")) %>%
group_by(dh,cell) %>%
summarise(counts=n())
grid <- dgcellstogrid(dggs,point_counts$cell,frame=TRUE,wrapcells=TRUE)
grid <- merge(grid,point_counts,by.x="Name",by.y="cell")
View(grid)
p <- ggmap::ggmap(ggmap::get_map(location = c(125,30,125,30), zoom = 4,  maptype = c("satellite"), source = 'google'))+
geom_polygon(data=grid, aes(x=long, y=lat, group=group, fill=counts, frame = dh), alpha=0.6)    +
geom_path   (data=grid,      aes(x=long, y=lat, group=group), alpha=0.4, color="white") +
scale_fill_gradient(low="yellow", high="red")+
theme_minimal()
p
p <- ggmap::ggmap(ggmap::get_map(location = c(125,30,125,30), zoom = 6,  maptype = c("satellite"), source = 'google'))+
geom_polygon(data=grid, aes(x=long, y=lat, group=group, fill=counts, frame = dh), alpha=0.6)    +
geom_path   (data=grid,      aes(x=long, y=lat, group=group), alpha=0.4, color="white") +
scale_fill_gradient(low="yellow", high="red")+
theme_minimal()
p
p <- ggmap::ggmap(ggmap::get_map(location = c(125,30,125,30), zoom = 5,  maptype = c("satellite"), source = 'google'))+
geom_polygon(data=grid, aes(x=long, y=lat, group=group, fill=counts, frame = dh), alpha=0.6)    +
geom_path   (data=grid,      aes(x=long, y=lat, group=group), alpha=0.4, color="white") +
scale_fill_gradient(low="yellow", high="red")+
theme_minimal()
p
gganimate::gg_animate(p, interval = .3)
p
p <- ggmap::ggmap(ggmap::get_map(location = c(120,30,120,30), zoom = 5,  maptype = c("satellite"), source = 'google'))+
geom_polygon(data=grid, aes(x=long, y=lat, group=group, fill=counts, frame = dh), alpha=0.6)    +
geom_path   (data=grid,      aes(x=long, y=lat, group=group), alpha=0.4, color="white") +
scale_fill_gradient(low="yellow", high="red")+
theme_minimal()
p <- ggmap::ggmap(ggmap::get_map(location = c(120,30,120,30), zoom = 5,  maptype = c("satellite"), source = 'google'))+
geom_polygon(data=grid, aes(x=long, y=lat, group=group, fill=counts, frame = dh), alpha=0.6)    +
geom_path   (data=grid,      aes(x=long, y=lat, group=group), alpha=0.4, color="white") +
scale_fill_gradient(low="yellow", high="red")+
theme_minimal()
p
grid$effort    <- log(grid$effort)
grid$counts    <- log(grid$counts)
p <- ggmap::ggmap(ggmap::get_map(location = c(120,30,120,30), zoom = 5,  maptype = c("satellite"), source = 'google'))+
geom_polygon(data=grid, aes(x=long, y=lat, group=group, fill=counts, frame = dh), alpha=0.6)    +
geom_path   (data=grid,      aes(x=long, y=lat, group=group), alpha=0.4, color="white") +
scale_fill_gradient(low="yellow", high="red")+
theme_minimal()
p <- ggmap::ggmap(ggmap::get_map(location = c(120,30,120,30), zoom = 5,  maptype = c("satellite"), source = 'google'))+
geom_polygon(data=grid, aes(x=long, y=lat, group=group, fill=counts, frame = dh), alpha=0.6)    +
geom_path   (data=grid,      aes(x=long, y=lat, group=group), alpha=0.4, color="white") +
scale_fill_gradient(low="yellow", high="red")+
theme_minimal()
p
gganimate::gg_animate(p, interval = .3)
p <- ggmap::ggmap(ggmap::get_map(location = c(125,30,125,30), zoom = 4,  maptype = c("satellite"), source = 'google'))+
geom_point(data = removed_vessels_effort_2015,
aes(x=lon, y=lat, frame = dh), color="red", size = 1)
gganimate::gg_animate(p, interval = .3)
removed_vessels_effort_2015 <- removed_vessels_effort_2015 %>%
mutate(dh = round_date(timestamp, unit = "hours")) %>%
arrange(dh)
p <- ggmap::ggmap(ggmap::get_map(location = c(125,30,125,30), zoom = 4,  maptype = c("satellite"), source = 'google'))+
geom_point(data = removed_vessels_effort_2015,
aes(x=lon, y=lat, frame = dh), color="red", size = 1)
p
gganimate::gg_animate(p, interval = .3)
gganimate::gg_animate(p, interval = .3, "China.mp4")
library(tidyverse)
library(bigrquery)
library(DBI)
library(lubridate)
library(dygraphs)
library(dggridR)
library(ggmap)
BQ_connection <-  dbConnect(dbi_driver(), dataset = "", project = "ucsb-gfw")
FADS <- read_csv("hawaii_FADS.csv")
ggmap::ggmap(ggmap::get_map(location = "Hawaii", zoom = 4,  maptype = c("satellite"), source = 'google'))
ggmap::ggmap(ggmap::get_map(location = "Hawaii",maptype = c("satellite"), source = 'google'))
ggmap::ggmap(ggmap::get_map(location = "Hawaiian Islands",maptype = c("satellite"), source = 'google'))
ggmap::ggmap(ggmap::get_map(location = "Hawaiian Islands",maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = 1)
FADS <- read_csv("hawaii_FADS.csv")
ggmap::ggmap(ggmap::get_map(location = "Hawaiian Islands",maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = 1)
ggmap::ggmap(ggmap::get_map(location = "Hawaiian Islands",maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red")
ggmap::ggmap(ggmap::get_map(location = "Hawaiian Islands",maptype = c("satellite"), source = 'google'))+
ggplot()+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red")
ggplot()+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red")
ggmap::ggmap(ggmap::get_map(location = "Hawaii",zoom = 2,maptype = c("satellite"), source = 'google'))
ggmap::ggmap(ggmap::get_map(location = "Hawaii",zoom = 5,maptype = c("satellite"), source = 'google'))
ggmap::ggmap(ggmap::get_map(location = "Hawaii",zoom = 5,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red")
ggmap::ggmap(ggmap::get_map(location = "Hawaii",zoom = 7,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red")
ggmap::ggmap(ggmap::get_map(location = "Hawaii",zoom = 8,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red")
FADS <- read_csv("hawaii_FADS.csv") %>%
filter(is.na(status))
ggmap::ggmap(ggmap::get_map(location = "Hawaii",zoom = 7,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red")
ggmap::ggmap(ggmap::get_map(location = c(-157,20,-157,20),zoom = 7,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red")
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,20),zoom = 7,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red")
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 7,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red")
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 8,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red")
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 7,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red")
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 7,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = 1)
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 7,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)
buffer_FADS <- FADS
coordinates( buffer_FADS ) <- c( "lon", "lat" )
proj4string( buffer_FADS ) <- CRS( "+proj=longlat +datum=WGS84" )
buffers <- gBuffer(sampledf, width=1000, byid=TRUE )
buffers <- rgeos::gBuffer(sampledf, width=1000, byid=TRUE )
buffers <- rgeos::gBuffer(buffer_FADS, width=1000, byid=TRUE )
FADS <- read_csv("hawaii_FADS.csv") %>%
filter(is.na(status)) %>%
data_frame()
FADS <- read_csv("hawaii_FADS.csv") %>%
filter(is.na(status)) %>%
as_data_frame()
buffer_FADS <- FADS
coordinates( buffer_FADS ) <- c( "lon", "lat" )
proj4string( buffer_FADS ) <- CRS( "+proj=longlat +datum=WGS84" )
buffers <- rgeos::gBuffer(buffer_FADS, width=1000, byid=TRUE )
buffer_FADS
FADS <- read_csv("hawaii_FADS.csv") %>%
filter(is.na(status)) %>%
select(-status) %>%
as_data_frame()
str(FADS)
buffer_FADS <- as_data_frame(FADS)
coordinates( buffer_FADS ) <- c( "lon", "lat" )
proj4string( buffer_FADS ) <- CRS( "+proj=longlat +datum=WGS84" )
buffers <- rgeos::gBuffer(buffer_FADS, width=1000, byid=TRUE )
buffers <- rgeos::gBuffer(sp::spTransform(buffer_FADS, CRS( "+init=epsg:3347" ) ) , width=1000, byid=TRUE )
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 7,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, fill = id),  alpha = .8,data = broom::tidy(buffers))
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 9,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, fill = id),  alpha = .8,data = broom::tidy(buffers))
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 9,maptype = c("satellite"), source = 'google'))+
# geom_point(data = FADS,
#            aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, fill = id),  alpha = .8,data = broom::tidy(buffers))
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 9,maptype = c("satellite"), source = 'google'))+
# geom_point(data = FADS,
#            aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = lon, y = lat, fill = id),  alpha = .8,data = broom::tidy(buffers))
ggplot()+
geom_polygon(aes(x = long, y = lat, fill = id),  alpha = .8,data = broom::tidy(buffers))
buffers <- rgeos::gBuffer(buffer_FADS %>%
sp::spTransform(CRS("+proj=utm +zone=4n +datum=WGS84")) , width=1000, byid=FALSE )
ggplot()+
geom_polygon(aes(x = long, y = lat, fill = id),  alpha = .8,data = broom::tidy(buffers))
buffers <- rgeos::gBuffer(buffer_FADS %>%
sp::spTransform(CRS("+proj=utm +zone=4n +datum=WGS84")) , width=1000, byid=TRUE )
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 9,maptype = c("satellite"), source = 'google'))+
# geom_point(data = FADS,
#            aes(x=lon, y=lat), color="red", size = .5)+
ggplot()+
geom_polygon(aes(x = long, y = lat, fill = id),  alpha = .8,data = broom::tidy(buffers))
ggplot()+
geom_polygon(aes(x = long, y = lat, fill = id),  alpha = .8,data = broom::tidy(buffers))
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 9,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat),  alpha = .8,data = broom::tidy(buffers))
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 9,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, fill = id),  alpha = .8,data = broom::tidy(buffers))
proj4string( buffers ) <- CRS( "+proj=longlat +datum=WGS84" )
proj4string( buffers ) <- sp::spTransformCRS( "+proj=longlat +datum=WGS84" )
proj4string( buffers ) <- CRS( "+proj=longlat +datum=WGS84" )
FADS <- read_csv("hawaii_FADS.csv") %>%
filter(is.na(status)) %>%
select(-status) %>%
as_data_frame()
buffer_FADS <- as_data_frame(FADS)
coordinates( buffer_FADS ) <- c( "lon", "lat" )
proj4string( buffer_FADS ) <- CRS( "+proj=longlat +datum=WGS84" )
buffers <- rgeos::gBuffer(buffer_FADS %>%
sp::spTransform(CRS("+proj=utm +zone=4n +datum=WGS84")) , width=1000, byid=TRUE )
proj4string( buffers )
buffers <- buffers %>%
sp::spTransform(CRS( "+proj=longlat +datum=WGS84" ))
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 9,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, fill = id),  alpha = .8,data = broom::tidy(buffers))
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 9,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat),  alpha = .8,data = broom::tidy(buffers))
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 9,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, fill = id),  alpha = .8,data = broom::tidy(buffers))
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 9,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, group = id),  alpha = .2,data = broom::tidy(buffers))
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 9,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, group = id),  alpha = .8,data = broom::tidy(buffers))
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 9,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, group = id, fill = "blue"),  alpha = .8,data = broom::tidy(buffers))
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 9,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 9,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, group = id), fill = "ligthblue",  alpha = .8,data = broom::tidy(buffers))
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 9,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, group = id), fill = "blue",  alpha = .8,data = broom::tidy(buffers))
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 9,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, group = id), fill = "blue",  alpha = .2,data = broom::tidy(buffers))
FADS <- read_csv("hawaii_FADS.csv") %>%
filter(is.na(status)) %>%
select(-status) %>%
as_data_frame()
buffer_FADS <- as_data_frame(FADS)
coordinates( buffer_FADS ) <- c( "lon", "lat" )
proj4string( buffer_FADS ) <- CRS( "+proj=longlat +datum=WGS84" )
buffers <- rgeos::gBuffer(buffer_FADS %>%
sp::spTransform(CRS("+proj=utm +zone=4n +datum=WGS84")) , width=1850, byid=TRUE )
buffers <- buffers %>%
sp::spTransform(CRS( "+proj=longlat +datum=WGS84" ))
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 9,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, group = id), fill = "blue",  alpha = .2, data = broom::tidy(buffers))
FADS <- read_csv("hawaii_FADS.csv") %>%
filter(is.na(status)) %>%
select(-status) %>%
as_data_frame()
buffer_FADS <- as_data_frame(FADS)
coordinates( buffer_FADS ) <- c( "lon", "lat" )
proj4string( buffer_FADS ) <- CRS( "+proj=longlat +datum=WGS84" )
buffers <- rgeos::gBuffer(buffer_FADS %>%
sp::spTransform(CRS("+proj=utm +zone=4n +datum=WGS84")) , width=1850*2, byid=TRUE )
buffers <- buffers %>%
sp::spTransform(CRS( "+proj=longlat +datum=WGS84" ))
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 9,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, group = id), fill = "blue",  alpha = .2, data = broom::tidy(buffers))
ggmap::ggmap(ggmap::get_map(location = "big island",zoom = 3,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, group = id), fill = "blue",  alpha = .2, data = broom::tidy(buffers))
ggmap::ggmap(ggmap::get_map(location = "big island",zoom = 7,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, group = id), fill = "blue",  alpha = .2, data = broom::tidy(buffers))
ggmap::ggmap(ggmap::get_map(location = "Kauai",zoom = 7,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, group = id), fill = "blue",  alpha = .2, data = broom::tidy(buffers))
ggmap::ggmap(ggmap::get_map(location = "Kauai",zoom = 10,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, group = id), fill = "blue",  alpha = .2, data = broom::tidy(buffers))
ggmap::ggmap(ggmap::get_map(location = "Kauai",zoom = 10,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, group = id), fill = "yellow",  alpha = .2, data = broom::tidy(buffers))
FADS <- read_csv("hawaii_FADS.csv") %>%
filter(is.na(status)) %>%
select(-status) %>%
as_data_frame()
buffer_FADS <- as_data_frame(FADS)
coordinates( buffer_FADS ) <- c( "lon", "lat" )
proj4string( buffer_FADS ) <- CRS( "+proj=longlat +datum=WGS84" )
buffers <- rgeos::gBuffer(buffer_FADS %>%
sp::spTransform(CRS("+proj=utm +zone=4n +datum=WGS84")) , width=1850*1, byid=TRUE )
buffers <- buffers %>%
sp::spTransform(CRS( "+proj=longlat +datum=WGS84" ))
ggmap::ggmap(ggmap::get_map(location = "Kauai",zoom = 10,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, group = id), fill = "yellow",  alpha = .2, data = broom::tidy(buffers))
kauai_effort <- kauai_effort %>%
mutate(month = round_date(timestamp, unit = "month"))
kauai_effort <- kauai_effort %>%
mutate(month = round_date(timestamp, unit = "month"))
kauai_effort <- kauai_effort %>%
mutate(month = round_date(timestamp, unit = "month")) %>%
arrange(timestamp)
View(kauai_effort)
ggmap::ggmap(ggmap::get_map(location = c(125,30,125,30), zoom = 4,  maptype = c("satellite"), source = 'google'))+
ggplot()+
geom_path(data = kauai_effort,
aes(x=lon, y=lat))
ggplot()+
geom_path(data = kauai_effort,
aes(x=lon, y=lat))
ggmap::ggmap(ggmap::get_map(location = c(125,30,125,30), zoom = 4,  maptype = c("satellite"), source = 'google'))+
geom_path(data = kauai_effort,
aes(x=lon, y=lat))
ggmap::ggmap(ggmap::get_map(location = "Kauai",zoom = 10,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_path(data = kauai_effort,
aes(x=lon, y=lat))
kauai_effort <- kauai_effort %>%
mutate(month = round_date(timestamp, unit = "month")) %>%
group_by(mmsi) %>%
arrange(timestamp) %>%
ungroup()
ggmap::ggmap(ggmap::get_map(location = "Kauai",zoom = 10,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_path(data = kauai_effort,
aes(x=lon, y=lat))
ggmap::ggmap(ggmap::get_map(location = "Kauai",zoom = 10,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_path(data = kauai_effort,
aes(x=lon, y=lat, group =mmsi))
ggmap::ggmap(ggmap::get_map(location = "Kauai",zoom = 10,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_path(data = kauai_effort,
aes(x=lon, y=lat, group = mmsi, col = mmsi))
ggmap::ggmap(ggmap::get_map(location = "Kauai",zoom = 10,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_path(data = kauai_effort,
aes(x=lon, y=lat, group = mmsi, col = as.factor(mmsi)))
View(kauai_effort)
kauai_effort <- kauai_effort %>%
mutate(month = round_date(timestamp, unit = "month")) %>%
group_by(mmsi) %>%
arrange(timestamp) %>%
ungroup()
View(kauai_effort)
View(kauai_effort)
kauai_effort <- kauai_effort %>%
mutate(month = round_date(timestamp, unit = "month")) %>%
group_by(mmsi) %>%
arrange(timestamp) %>%
ungroup()
View(kauai_effort)
View(kauai_effort)
kauai_effort <- kauai_effort %>%
mutate(month = round_date(timestamp, unit = "month")) %>%
arrange(timestamp)
ggmap::ggmap(ggmap::get_map(location = "Kauai",zoom = 10,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_path(data = kauai_effort,
aes(x=lon, y=lat, group = mmsi, col = as.factor(mmsi)))
View(kauai_effort)
kauai_effort <- kauai_effort %>%
mutate(month = round_date(timestamp, unit = "month")) %>%
arrange(timestamp)
ggmap::ggmap(ggmap::get_map(location = "Kauai",zoom = 10,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_path(data = kauai_effort,
aes(x=lon, y=lat, group = mmsi, col = as.factor(mmsi)))
View(kauai_effort)
ggmap::ggmap(ggmap::get_map(location = "oahu",zoom = 10,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, group = id), fill = "yellow",  alpha = .2, data = broom::tidy(buffers))
kauai_effort <- kauai_effort %>%
mutate(month = round_date(timestamp, unit = "month")) %>%
arrange(timestamp)
ggmap::ggmap(ggmap::get_map(location = "oahu",zoom = 10,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_path(data = kauai_effort,
aes(x=lon, y=lat, group = mmsi, col = as.factor(mmsi)))
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 10,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, group = id), fill = "yellow",  alpha = .2, data = broom::tidy(buffers))
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 5,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, group = id), fill = "yellow",  alpha = .2, data = broom::tidy(buffers))
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 7,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_polygon(aes(x = long, y = lat, group = id), fill = "yellow",  alpha = .2, data = broom::tidy(buffers))
hawaii_effort <- hawaii_effort %>%
mutate(month = round_date(timestamp, unit = "month")) %>%
arrange(timestamp)
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 7,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_path(data = hawaii_effort,
aes(x=lon, y=lat, group = mmsi, col = as.factor(mmsi)))
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 7,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_path(data = hawaii_effort,
aes(x=lon, y=lat, group = mmsi, col = as.factor(mmsi)))+
guides(fill=FALSE)
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 7,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_path(data = hawaii_effort,
aes(x=lon, y=lat, group = mmsi, col = as.factor(mmsi)))+
guides(col=FALSE)
ggmap::ggmap(ggmap::get_map(location = c(-157,21,-157,21),zoom = 7,maptype = c("satellite"), source = 'google'))+
geom_point(data = FADS,
aes(x=lon, y=lat), color="red", size = .5)+
geom_path(data = hawaii_effort,
aes(x=lon, y=lat, group = mmsi, col = as.factor(mmsi)), alpha = .2)+
guides(col=FALSE)
knit_with_parameters('~/github/psychic-guide-squirrel/economics_and_policy_illustrations/dynamic_ocean_management.Rmd')
